# План реализации CalDavServer

## 1. Архитектура и структура проекта
- [x] Создать структуру каталогов и файлов проекта
- [x] Добавить README с описанием

## 2. Модели и база данных
- [x] Модель User
- [x] Модель Calendar
- [x] Модель Event
- [x] Контекст ApplicationDbContext для EF Core
- [ ] Миграции и настройка подключения к реальной БД
- [ ] Модели ACL и прав доступа

## 3. Контроллеры и API
- [x] CalDavController (заглушка)
- [x] CalendarController (CRUD, заглушка)
- [x] EventController (CRUD, заглушка)
- [x] AuthController (заглушка)
- [ ] Реализация CalDAV/WebDAV-методов (PROPFIND, REPORT, PUT, DELETE, MKCALENDAR и др.)
- [ ] Реализация ACL и делегирования

## 4. Сервисы и бизнес-логика
- [x] CalendarService (заглушка)
- [x] EventService (заглушка)
- [x] AuthService (заглушка)
- [ ] Реализация бизнес-логики для календарей, событий, аутентификации
- [ ] Импорт/экспорт .ics
- [ ] Free-busy отчеты
- [ ] Сериализация календарей и событий в файлы (.ics) и их загрузка из файлов

## 5. Утилиты
- [x] IcsHelper (заглушка)
- [x] WebDavHelper (заглушка)
- [ ] Парсинг и генерация iCalendar
- [ ] Парсинг и генерация WebDAV XML

## 6. DTO и маппинг
- [x] CalendarDto
- [x] EventDto
- [x] UserDto
- [ ] Маппинг между моделями и DTO

## 7. Конфигурация и инфраструктура
- [x] appsettings.json (базовый)
- [ ] Настройка EF Core и миграций
- [ ] Настройка аутентификации (Basic, OAuth2)
- [ ] Настройка HTTPS

## 8. Тестирование
- [x] Примеры юнит-тестов для сервисов
- [ ] Покрытие бизнес-логики тестами
- [ ] Интеграционные тесты с CalDAV-клиентами

## 9. Документация
- [x] README.md
- [ ] Swagger/OpenAPI для REST API
- [ ] Архитектурная документация
- [ ] Руководство по установке и эксплуатации

---

## Что еще требуется сделать

- Реализовать бизнес-логику для всех сервисов и контроллеров
- Настроить подключение к реальной БД и миграции
- Реализовать обработку CalDAV/WebDAV-методов согласно спецификациям
- Реализовать ACL и делегирование прав
- Импорт/экспорт событий в формате iCalendar
- Реализовать аутентификацию (Basic, OAuth2)
- Настроить HTTPS и безопасность
- Покрыть тестами бизнес-логику и интеграцию с клиентами
- Подготовить Swagger/OpenAPI и архитектурную документацию
- Провести тестирование с реальными CalDAV-клиентами

---

# Пользовательская инструкция

1. Для доступа к серверу используйте любой CalDAV-совместимый клиент (например, Apple Calendar, Thunderbird, Outlook).
2. В настройках клиента укажите URL сервера, логин и пароль (или OAuth2-токен, если настроено).
3. Создавайте, редактируйте и удаляйте календари и события через привычный интерфейс клиента — все изменения будут синхронизированы с сервером.
4. Для совместного доступа и делегирования используйте функции управления правами в клиенте или через API.
5. Для импорта/экспорта событий используйте формат .ics.

# Инструкция по установке

1. Установите .NET 7 SDK и Microsoft SQL Server (или совместимую СУБД).
2. Клонируйте репозиторий:
   ```bash
   git clone <адрес-репозитория>
   cd <папка-проекта>
   ```
3. В корне выполните:
   ```bash
   dotnet restore
   dotnet ef database update
   dotnet run
   ```
4. Откройте Swagger UI (обычно http://localhost:5000/swagger) для тестирования API или подключите CalDAV-клиент.
5. Для настройки аутентификации и других параметров используйте файл appsettings.json.
6. Для запуска в production настройте HTTPS и переменные окружения.